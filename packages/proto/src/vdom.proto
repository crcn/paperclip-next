syntax = "proto3";
package paperclip.vdom;

// Virtual DOM node (discriminated union)
message VNode {
  oneof node_type {
    ElementNode element = 1;
    TextNode text = 2;
    CommentNode comment = 3;
    ComponentNode component = 4;
    ErrorNode error = 5;  // Inline error display
  }
}

message ErrorNode {
  string message = 1;
  string semantic_id = 2;
}

message ElementNode {
  string tag = 1;
  map<string, string> attributes = 2;
  map<string, string> styles = 3;
  repeated VNode children = 4;
  string semantic_id = 5;  // Stable identity for diffing
  optional string key = 6;  // Explicit key for repeat items
}

message TextNode {
  string content = 1;
}

message CommentNode {
  string content = 1;
}

message ComponentNode {
  string component_id = 1;
  map<string, string> props = 2;
  repeated VNode children = 3;
  string semantic_id = 4;  // Stable identity for diffing
}

message VDocument {
  repeated VNode nodes = 1;
  repeated CssRule styles = 2;
}

message CssRule {
  string selector = 1;
  map<string, string> properties = 2;
}
